<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Desk Controller</title>
    <link rel="stylesheet" href="/static/css/base.css">
    <link rel="stylesheet" href="/static/css/layout.css">
    <link rel="stylesheet" href="/static/css/desk-cards.css">
    <link rel="stylesheet" href="/static/css/popups-auth.css">
    <script src="https://cdn.jsdelivr.net/npm/luxon@3"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-luxon"></script>
    <script src="/static/script.js"></script>
    <script src="/static/charts.js"></script>
    <script src="/static/deskcontrol.js"></script>
    <script src="/static/deskschedule.js"></script>
    <script src="https://kit.fontawesome.com/56dbcf3753.js" crossorigin="anonymous"></script>
</head>

<body>

    <header class="main-header">
        <div class="header-content">
            <h1>Desk Controller</h1>
            <a href="/logout" class="logout-btn">Logout</a>
        </div>
        <div id="clock" class="clock"></div>
    </header>
    <div class="container">
        <div class="all-desks-control">
            <h2>Control All Desks</h2>
            <div class="control-group">
                <input type="number" id="height_all" placeholder="Height (mm)" step="10">
                <button class="btn-primary" onclick="setHeightAll()">Set All</button>
                <button id="lock_all" class="btn-secondary" onclick="toggleLockAll()">Lock All</button>
            </div>
        </div>
    </div>
    <div class="container">
        <div id="desks" class="desks-grid"></div>
        <template id="desk-card-template">
            <div class="desk-card">
                <div class="desk-header">
                    <h3 class="desk-name"></h3>
                    <span class="desk-id"></span>
                </div>
                <div class="desk-error" style="display:none;"></div>
                <div class="desk-position">
                    <div class="position-label">Current Height</div>
                    <div class="position-value"><span class="pos"></span> mm</div>
                </div>
                <div class="desk-controls">
                    <div class="control-group">
                        <label class="control-label">Quick Controls</label>
                        <div class="button-group">
                            <button class="btn-up">Up</button>
                            <button class="btn-down">Down</button>
                        </div>
                    </div>
                    <div class="control-group">
                        <label class="control-label">Set Height</label>
                        <div class="input-group">
                            <input type="number" class="height-input" placeholder="mm">
                            <button class="btn-step">Set</button>
                        </div>
                    </div>
                    <div class="control-group">
                        <label class="control-label">Lock Position</label>
                        <button class="btn-stop btn-full lock-btn">Lock Desk</button>
                    </div>
                    <div class="control-group">
                        <label class="control-label">Schedule</label>
                        <div class="schedule-inputs">
                            <input type="number" class="hour-input" placeholder="H">
                            <input type="number" class="minute-input" placeholder="M">
                            <input type="number" class="sched-height-input" placeholder="mm">
                        </div>
                        <button class="btn-step btn-full schedule-btn">Schedule</button>
                    </div>
                </div>
            </div>
        </template>
    </div>
    <div class="container">
        <div class="deskSwitcher" id="deskSwitcherContainer" style="display:none;">
            <label for="deskSwitcher">Desk:</label>
            <select id="deskSwitcher"></select>
        </div>
    </div>
    <div class="container">
        <div id="stats" class="stats-section">
            <h2>Statistics</h2>
            <div class="charts-grid">
                <div class="chart-card">
                    <canvas id="myChart"></canvas>
                </div>
                <div class="chart-card">
                    <canvas id="myChart2"></canvas>
                </div>
                <div class="chartCard3">
                    <div class="chartBox3">
                        <div>Desk Position in CM</div>
                        <div id="lineLegend" class="fixedLegend"></div>

                        <div class="container3">
                            <div class="containerBody3">
                                <canvas id="lineChart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </div>
        <div id="debugPanel">
            <div>Standing: <span id="dbgStanding">0</span></div>
            <div>Neutral: <span id="dbgNeutral">0</span></div>
            <div>Sitting: <span id="dbgSitting">0</span></div>
            <div>Transitions: <span id="dbgTransitions">0</span></div>
        </div>

        <div class="chartCard2">
            <div class="chartBox2">
                <div class="container2">
                    <div class="containerBody2">
                        <canvas id="myChart4"></canvas>
                    </div>
                </div>
            </div>
        </div>
        <div id="schedule" class="schedule-section"></div>
        <div id="system-popups" class="system-popups" aria-live="polite" aria-atomic="true"></div>
    </div>
    <!--USE CHARTS.JS link to the docs: https://www.chartjs.org/docs/latest/getting-started/ -->
    <script>
        updatePage();
        setInterval(updatePage, 5000); // update page every 5s
        updateClock();
        setInterval(updateClock, 1000);
    </script>
</body>

</html>